# 性能测试

## 思维差异

- 功能测试、自动化测试
  - 输出： 找bug  预期结果与实际结果进行比较
  - 隐藏的前提：模拟都是1个用户的操作

  + 性能测试
    + 不是模拟1个人，**模拟多个人同时**，
    + 关注==>多个人操作时，响应时间，
    + 接口服务器性能测试中，一定是多个人同时操作，才是性能测试

## 性能测试概念

100个人同时登录接口进行登录，性能中的`avgRT(平均响应时间)`应该在多少，是可以被接受的？

- 可接受的范围 1.5s，常规说的2-5-8为域名的响应时间
- 1.5s APDEX 用户满意度指数

事务：一个请求行为，并不一定只有一个接口，所以，一个事务可能是多个接口。

- jmeter：默认情况下，1个接口请求一次，认为一个1个事务`Transation`
  - 也可以是通过事务控制器，挂载多个接口请求，合并成为1个事务
- 是从发起，到网络传输，收到响应

## 什么是性能测试

性能：事务、物品的某些特征的评价值

## 性能测试

- 通过工具，模拟多用户发起请求，获取**性能指标值**
  - 用工具来模拟多个人的方式很多
    - 进程： 资源拥有者，创造进程消耗的是CPU、和内存。资源消耗会比较大。LR
      - 进程+ 线程： ngrinder
      - 协程： python+locust
    - 线程:  使用进程的资源，来干。jmeter、lr

## 性能指标

- `avgRT`	平均响应时间	90%
- `TPS`        服务器每秒处理的事务数
  - **衡量服务器处理能力**的最重要的指标
- 吞吐量：**网络**中每秒传输的事务数
  - **没有网络瓶颈**：tps 数值 = 吞吐量数值
  - **如果网络有瓶颈**: tps 数值 != 吞吐量数值
- 吞吐率  每秒钟能通过多少kb数据
- 服务器资源利用率
  - cpu、内存、io的利用率
- 并发用户数：
  - 同一时间发起请求 用户数
    + 广义并发： 同一时间发起请求(相同、不相同)
    + 狭义并发：同一时间发起相同请求
         + 集合点：集合多个人在同一时间发起相同请求
  - 并发用数100   发起请求，一秒钟会发起多少请求？（请求的频率）不知道，所以1秒钟总请求量，不知道，

## 负载测试

- **逐步增加**并发用户数，测试系统性能变化，找出最大 拐点区间
  -  逐步增加并发用户数，
  -  区间怎么判断
    - 有没有报错
    - tps下降
    - 响应时间变长

50tps： 服务器每秒能处理50个事务

50 t/s  * 60 * 60 = 18w     300tps

假设一天为8h：18w  * 8h  = 144w

### 压力测试

在一定的性能压力下，持续运行一个较长时间，看系统服务以及各资源利用情况稳定性，一般以小时为单位7*24小时。



